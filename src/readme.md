# CD3
Утилита для парсинга html Ютуба и скачивания комментариев к видео.
Переписываю аналогичный кодна Питоне, пока всё подряд накидываю в Мейне, потом порефакторю. В перспективе будет сервис.

## Алгоритм
Сначала получаем html, оттуда берем конфигурацию, часть которой будем использовать в ajax-запросах

находим эндпойнты, характерные для прокрутки и дальнейшей подгрузки, для каждого (они называются continuations) делаем ajax-запрос и парсим ответ. 
Если в ответе находим другие эндпойнты для следующих ajax-запросов, их тоже добавляем в список continuations

## Текущее состояние:
Вроде работает, но количество выданных комментариев не совпадает со счетчиком,который отображает ЮТ над блоклм комментов. При ручном подсчете вышлорасхождение в 1 коммент, так что скорее всего дело в скрытых или удаленных модератором. Для наших целей это хороший результат.

В исходном скрипте не реализована группировка, то есть если коммент вляется ответом, то непонятно, на что конкретно это ответ. 
Строгоговоря, есть 2 вида "ответов" - список ответов к первому 

В выводе есть только boolean reply = true и айдишник коммента, который состоит из двух частей. 
Попробуем проанализировать айдишники, надо составить таблицу

|id ориг                                | id ответа                                         | текст для поиска
+---------------------------------------+---------------------------------------------------+----------------------------------------------
|Ugz25cqFRKgIIVYpzZp4AaABAg             |                                                   |Земля плоская! Электричества не существует!
|                                       |Ugz25cqFRKgIIVYpzZp4AaABAg.A547Lcuvd9AA548QuyCbBn  |Три слона уже устали
|                                       |Ugz25cqFRKgIIVYpzZp4AaABAg.A547Lcuvd9AA549Chp7qJJ  |Настоящий бог Колбас!

|UgwSZa9HUSBkMsloDBh4AaABAg             |                                                   |Тргда может бахнем ?
|                                       |UgwSZa9HUSBkMsloDBh4AaABAg.A544MKu4LeBA549aCz_x0K  |Может и бахнем , но позже

|UgyhTnBOZUlAKdKPKhV4AaABAg             |                                                   |Посмотрим какой это фейк, когда бахнут
|                                       |UgyhTnBOZUlAKdKPKhV4AaABAg.A543zZxY-FlA54ErR7cyE2  |Не бахнут,ато фейк расскроется

В общем, все понятно: root-комментарий имеет короткий id, ответы на него имеют расширенный id через точку. Отличный простой способ отобразить ветки ответов. Добавим в наш вывод reply и id, конечный список отсортируем. Напишем компаратор по двум прропертям - первая часть айдишника , и порядковый номер в изначальном списке выдачи.
